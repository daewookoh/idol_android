<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.VIBRATE" />

    <!-- Google 로그인을 위한 계정 접근 권한 (Android 6.0 이상에서 런타임 요청) -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />

    <!-- 푸시 알림 권한 (Android 13 이상) -->
    <uses-permission
        android:name="android.permission.POST_NOTIFICATIONS"
        android:minSdkVersion="33" />

    <!-- SNS 로그인을 위한 패키지 쿼리 (Android 11 이상) -->
    <queries>
        <package android:name="com.facebook.katana" />
        <package android:name="com.kakao.talk" />
        <package android:name="jp.naver.line.android" />
    </queries>

    <application
        android:name=".IdolApplication"
        android:allowBackup="false"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.Idol_android">
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:label="@string/app_name"
            android:theme="@style/Theme.Idol_android">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>

            <!-- Custom scheme for deep linking -->
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="${devscheme}" />
            </intent-filter>

            <!-- Share text intent -->
            <intent-filter>
                <action android:name="android.intent.action.SEND" />

                <category android:name="android.intent.category.DEFAULT" />

                <data android:mimeType="text/plain" />
            </intent-filter>

            <!-- Share image intent -->
            <intent-filter>
                <action android:name="android.intent.action.SEND" />

                <category android:name="android.intent.category.DEFAULT" />

                <data android:mimeType="image/*" />
            </intent-filter>

            <!-- HTTP/HTTPS deep links with auto verify -->
            <intent-filter android:autoVerify="true">
                <action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="https" />
                <data android:scheme="http" />
                <data android:host="${host_wildcard}" />

                <!-- Various app deep link paths -->
                <data android:pathPrefix="/webview/invite_share" />
                <data android:pathPrefix="/community" />
                <data android:pathPrefix="/idol" />
                <data android:pathPrefix="/coupon" />
                <data android:pathPrefix="/articles" />
                <data android:pathPrefix="/supports" />
                <data android:pathPrefix="/themepick" />
                <data android:pathPrefix="/live" />
                <data android:pathPrefix="/onepick" />
                <data android:pathPrefix="/heartpick" />
                <data android:pathPrefix="/quizzes" />
                <data android:pathPrefix="/store" />
                <data android:pathPrefix="/offerwall" />
                <data android:pathPrefix="/qna" />
                <data android:pathPrefix="/board" />
                <data android:pathPrefix="/records" />
                <data android:pathPrefix="/facedetect" />
                <data android:pathPrefix="/notices" />
                <data android:pathPrefix="/events" />
                <data android:pathPrefix="/menu" />
                <data android:pathPrefix="/awards" />
                <data android:pathPrefix="/hottrends" />
                <data android:pathPrefix="/bannergram" />
                <data android:pathPrefix="/attendance" />
                <data android:pathPrefix="/friends" />
                <data android:pathPrefix="/schedules" />
                <data android:pathPrefix="/miracle" />
                <data android:pathPrefix="/feed" />
                <data android:pathPrefix="/myinfo" />
                <data android:pathPrefix="/rookie" />
                <data android:pathPrefix="/invite" />
                <data android:pathPrefix="/auth" />
            </intent-filter>

            <!-- App custom scheme -->
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="${scheme}" />
            </intent-filter>
        </activity>

        <!-- ============================================================ -->
        <!-- SNS 로그인 SDK 설정 (old 프로젝트와 동일) -->
        <!-- ============================================================ -->

        <!-- Kakao SDK App Key -->
        <meta-data
            android:name="com.kakao.sdk.AppKey"
            android:value="${KAKAO_APP_KEY_FOR_MANIFEST}" />

        <!-- Facebook SDK Application ID -->
        <meta-data
            android:name="com.facebook.sdk.ApplicationId"
            android:value="@string/facebook_app_id" />

        <!-- Facebook SDK Client Token -->
        <meta-data
            android:name="com.facebook.sdk.ClientToken"
            android:value="${FACEBOOK_CLIENT_ID}" />

        <!-- Facebook SDK Auto Init (자동 초기화 비활성화) -->
        <meta-data
            android:name="com.facebook.sdk.AutoInitEnabled"
            android:value="false" />

        <!-- Facebook SDK Auto App Event Logging (자동 이벤트 로깅 비활성화) -->
        <meta-data
            android:name="com.facebook.sdk.AutoLogAppEventsEnabled"
            android:value="false" />

        <!-- Facebook Login Activity -->
        <activity
            android:name="com.facebook.FacebookActivity"
            android:configChanges="keyboard|keyboardHidden|screenLayout|screenSize|orientation"
            android:label="@string/app_name" />

        <!-- Facebook Custom Tab Activity for OAuth -->
        <activity
            android:name="com.facebook.CustomTabActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <data android:scheme="@string/fb_login_protocol_scheme" />
            </intent-filter>
        </activity>

        <!-- Kakao OAuth Handler Activity -->
        <activity
            android:name="com.kakao.sdk.auth.AuthCodeHandlerActivity"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />

                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />

                <!-- Redirect URI: "kakao${NATIVE_APP_KEY}://oauth" -->
                <data
                    android:host="oauth"
                    android:scheme="kakao${KAKAO_APP_KEY_FOR_MANIFEST}" />
            </intent-filter>
        </activity>

    </application>

</manifest>